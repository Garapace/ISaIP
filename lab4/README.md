# Лабораторная работа №4. КРИПТОГРАФИЧЕСКАЯ ЗАЩИТА ИНФОРМАЦИИ
## 1. Цель работы
1.1. Ознакомиться с основными методами криптографической защиты информации.
1.2. Получить практические навыки создания ПО по криптографическим преобразованиям информации.
## 2. Общие теоретические сведения
По мере развития и усложнения средств, методов и форм автоматизации процессов обработки информации повышается зависимость общества от степени безопасности используемых им информационных технологий, которая определяется степенью защищенности и устойчивости как компьютерных систем в целом, так и отдельных программ.
Для обеспечения защиты информации в настоящее время не существует какого-то одного технического приема или средства, однако общим в решении многих проблем безопасности является использование криптографии и криптоподобньгх преобразований информации.
Криптография - обеспечивает сокрытие смысла сообщения с помощью шифрования и открытия его расшифрованием, которые выполняются по специальным алгоритмам с помощью ключей.
Ключ - конкретное секретное состояние некоторых параметров алгоритма криптографического преобразования данных, обеспечивающее выбор только одного варианта из всех возможных для данного алгоритма
Криптоанализ - занимается вскрытием шифра без знания ключа (проверка устойчивости шифра).
Кодирование - (не относится к криптографии) -- система условных обозначений, применяемых при передаче информации. Применяется для увеличения качества передачи информации, сжатия информации и для уменьшения стоимости хранения и передачи.
Криптографические преобразования имеют цель обеспечить недоступность информации для лиц. не имеющих ключа, и поддержание с требуемой надежностью обнаружения несанкционированных искажений.
Большинство средств зашиты информации базируется на использовании криптографических шифров и процедур шифрования- расшифрования. В соответствии со стандартом ГОСТ 28147-89 под шифром понимают совокупность обратимых преобразований множества открытых данных на множество зашифрованных данных, задаваемых ключом и алгоритмом преобразования.
B криптографии используются следующие основные алгоритмы шифрования:
• алгоритм замены (подстановки) - символы шифруемого текста заменяются символами того же или другого алфавита в соответствии с заранее обусловленной схемой замены;
• алгоритм перестановки - символы шифруемого текста переставляются по определенному правилу в пределах некоторого блока этого текста;
• гаммирование - символы шифруемого текста складываются с символами некоторой случайной последовательности;
• аналитическое преобразование - преобразование шифруемого текста по некоторому аналитическому правилу (формуле).
Процессы шифрования и расшифрования осуществляются в рамках некоторой криптосистемы Для симметричной криптосистемы характерно применение одного и того же ключа как при шифровании, так и при расшифровании сообщений. В асимметричных криптосистемах для зашифрования данных используется один (общедоступный) ключ, а для расшифрования - другой (секретный) ключ.
### 2.1. Симметричные криптосистемы
#### 2.1.1. Шифры перестановки
В шифрах средних веков часто использовались таблицы, с помощью которых выполнялись простые процедуры шифрования, основанные на перестановке букв в сообщении. Ключом в данном случае является размеры таблицы. Например, сообщение "Неясное становится еще более непонятным" записывается в таблицу из 5 строк и 7 столбцов по столбцам.

| Н | О | Н | С | Б | Н | Я |
| Е | Е | О | Я | О | Е | Т |
| Я | С | В | Е | Л | П | Н |
| С | Т | И | Щ | Е | О | Ы |
| Н | А | Т | Е | Е | Н | М |
Для получения шфированного сообщения текст считывается по строкам и группируется по 5 букв: "НОНСБ НЯЕЕО ЯОЕТЯ СВЕЛП НСТИЩ ЕОЫНА ТЕЕНМ"
Несколько большей стойкостью к раскрытию обладает метод одиночной перестановки по ключу. Он отличается от предыдущего тем, что столбцы таблицы переставляются по ключевому слову, фразе или набору чисел длиной в строку таблицы. Используя в качестве ключа слово ЛУНАТИК, получим следующую таблицу:
       До перестановки                 После перестановки
| Л | У | Н | А | Т | И | К |  \  | А | И | К | Л | Н | Т | У |
| 4 | 7 | 5 | 1 | 6 | 2 | 3 |  /  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
| Н | О | Н | С | Б | Н | Я |  \  | С | Н | Я | Н | Н | Б | О |
| Е | Е | О | Я | О | Е | Т |  /  | Я | Е | Т | Е | О | О | Е |
| Я | С | В | Е | Л | П | Н |  \  | Е | П | Н | Я | В | Л | С |
| С | Т | И | Щ | Е | О | Ы |  /  | Щ | О | Ы | С | И | Е | Т |
| Н | А | Т | Е | Е | Н | М |  \  | Е | Н | М | Н | Т | Е | А |


В верхней строке левой таблицы записан ключ, а номера под буквами ключа определены в соответствии с естественным порядком соответствующих букв ключа в алфавите. Если в ключе встретились бы одинаковые буквы, они бы нумеровались слева направо Получается шифровка: СНЯНН БОЯЕТ ЕООЕЕ ПНЯВЛ СЩОЫС ИЕТЕН МНТЕА. Для обеспечения дополнительной скрытности можно повторно шифровать сообщение, которое уже было зашифровано. Для этого размер второй таблицы подбирают так, чтобы длины ее строк и столбцов отличались от длин строк и столбцов первой таблицы. Лучше всего, если они будут взаимно простыми.
#### 2.1.2. Шифры простой замены
Система шифрования Цезаря - частный случай шифра простой замены. Метод основан на замене каждой буквы сообщения на другую букву того же алфавита, путем смещения от исходной буквы на К букв.
Известная фраза Юлия Цезаря VENI VINI VICI - пришел, увидел, победил зашифрованная с помощью данного метода, преобразуется в SBKF SFAF SFZF (при смещении на 4 символа).
#### 2.1.3. Шифры сложной замены
**Шифр Гронсфельда** состоит в модификации шифра Цезаря числовым ключом. Для этого под буквами сообщения записывают цифры числового ключа. Если ключ короче сообщения, то его запись циклически повторяют. Шифротекст получают примерно также, как в шифре Цезаря, но отсчитывают не третью букву по алфавиту (как в шифре Цезаря), а ту, которая смещена по алфавиту на соответствующую цифру ключа.
Пусть в качестве ключа используется группа из трех цифр 314, тогда
Текст   | СОВЕРШЕННО СЕКРЕТНО
Ключ    | 3143143143143143143
Шифр    | ФПЕИСЬИОССАХИЛФИУСС
#### 2.1.4. Шифр многоалфавитной замены
Для шифрования каждого символа исходного сообщения применяется свой шифр простой замены (свой алфавит).
    | АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ_
A   | АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ_
Б   | _АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ
В   | Я_АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮ
Г   | ЮЯ_АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭ
.   | ..................................
Я   | АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ_АБ
_   | БВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ_А
Каждая строка в этой таблице соответствует одному шифру замены аналогично шифру Цезаря для алфавита, дополненного пробелом. При шифровании сообщения его выписывают в строку, а под ним ключ. Если ключ оказался короче сообщения, то его циклически повторяют. Шифротекст получают, находя символ в колонке таблицы по букве текста и строке, соответствующей букве ключа. Например, используя ключ АГАВА, из сообщения ПРИЕЗЖАЮ ШЕСТОГО получаем следующую шифровку:
Сообщение | ПРИЕЗЖАЮ_ШЕСТОГО
Ключ      | АГАВААГАВААГАВАА
Шифр      | ПНИГЗЖЮЮЮАЕОТМГО
**Шифр Виженера** представляет собой аналогичную многоалфавитную систему шифрования,в которой В первую строку квадрата заносится перестановка из букв алфавита. Во второй строке та же перестановка циклически сдвигается на одну позицию влево, в третьей - на две и т.д. Таким образом, квадрат состоит из N перестановок.
#### 2.1.5. Гаммирование
Процесс зашифрования заключается в генерации гаммы шифра и наложении этой гаммы на исходный открытый текст. Перед шифрованием открытые данные разбиваются на блоки Т(0) , одинаковой длины (по 64 бита). Гамма шифра вырабатывается в виде последовательности блоков Г(ш) , аналогичной длины (Т(ш) =Г(ш) +Т(0) , где "+" -побитовое сложение, i=l- m). Процесс расшифрования сводится к повторной генерации шифра текста и наложение этой гаммы на зашифрованные данные Т(0) -Г(ш) +Т(ш)
### 2.2. Асимметричные криптосистемы
#### 2.2.1. Схема шифрования Эль Гамаля
Алгоритм шифрования Эль Гамаля основан на применении больших чисел для генерации открытого и закрытого ключа, криптостойкость же обусловлена сложностью вычисления дискретных логарифмов. Последовательность действий пользователя:
1. Получатель сообщения выбирает два больших числа Р и G, причем P > G.
2. Получатель выбирает секретный ключ - случайное целое число X < Р.
3. Вычисляется открытый ключ Y= G^x mod P.
4. Получатель выбирает целое число К, 1 < K < P-1.
1. Шифрование сообщения (M): a = G^K mod P, b = Y^K mod P, где пара чисел (a,b) является шифротекстом.
## 3. Задание
Разработать и реализовать программу криптографического преобразования текстового файла. Для разработки использовать любую из перечисленных сред программирования: Turbo Pascal, Delphi, C++ Builder, Visual C++.
## 4. Требования к программе
1. Программа должна обеспечивать работу в двух режимах:
    * Криптографическое преобразование текста методом Цезаря;
    * Криптографическое преобразование текста методом Виженера.
2. В режиме криптографического преобразования текста методом Цезаря должны быть реализованы следующие функции:
    * исходный текст, из пользовательского файла "<имя файла>.txt", длинной не менее 2000 символов зашифровать методом Цезаря, с ключом N определяемым пользователем;
    * cохранить шифротекст в файл "encC <имя файла>.txt"
    * расшифровать текст и сохранить в файл "decC <имя файла>.txt"
    * вывести первые строки файлов "<имя файла>.txt", "encC <имя файла>.txt" и "decC <имя файла>.txt" в текстовое окно.
3. В режиме криптографического преобразования текста методом Виженера должны быть реализованы следующие функции:
    * Реализовать 2 варианта выбора алфавита замены:
        * Случайным образом;
        * По порядку.
    * Построить и вывести на экран квадрат Виженера
    * исходный текст, из пользовательского файла "<имя файла>. txt", длинной не менее 2000 символов зашифровать методом Виженера, с ключом определяемым пользователем;
    * cохранить шифротекст в файл "encV_<имя файла>.txt"
    * расшифровать текст и сохранить в файл "decV <имя файла>.txt"
    * вывести первые строки файлов "<имя файла>.txt", "encV_<имя файла>.txt" и "decV_<имя файла>.txt" в текстовое окно.
## 5. Содержание отчета:
- название и цель работы;
- фрагменты зашифрованного и расшифрованного текста;
- листинг программы;